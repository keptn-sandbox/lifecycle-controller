---
comments: true
---

# KeptnApp

A `KeptnApp` resource lists all the [workloads](https://kubernetes.io/docs/concepts/workloads/)
that constitute a logical application.
Keptn auto-generates it to work with the corresponding
[KeptnAppContext](appcontext.md).
It contains information about:
all [workloads](https://kubernetes.io/docs/concepts/workloads/) and checks
that are associated with a Keptn application

## Synopsis

```yaml
apiVersion: lifecycle.keptn.sh/v1alpha3
kind: KeptnApp
metadata:
  name: <app-name>
  namespace: <application-namespace>
  labels:
     my-custom-label: <label-name>
     app.kubernetes.io/managed-by: keptn
spec:
  version: "x.y"
  revision: x
  workloads:
  - name: <workload1-name>
    version: <version-string>
  - name: <workload2-name>
    version: <version-string>
```

## Fields

The first set of fields are created automatically
when the app discovery feature generates the `KeptnApp` resource:

- **apiVersion** -- API version being used.
- **kind** -- Resource type.
   Must be set to `KeptnApp`

- **metadata**
  - **name** -- Unique name of this application.
       Names must comply with the
       [Kubernetes Object Names and IDs](https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#dns-subdomain-names)
       specification.
  - **namespace** -- Namespace of this application.
  - **labels**
    - **my-custom-label**
    - **app-kibernetes.io/managed-by:keptn**

- **spec**
  - **version** (required) -- version of the Keptn application.
       Changing this version number causes a new execution
       of all application-level checks
  - **revision** -- revision of a `version`.
       The value is an integer that can be modified
       to trigger another deployment of a `KeptnApp` of the same version.
       For example, increment this number to restart a `KeptnApp` version
       that failed to deploy, perhaps because a
       `preDeploymentEvaluation` or `preDeploymentTask` failed.
       See
       [Restart an Application Deployment](../../guides/restart-application-deployment.md)
       for a longer discussion of this.
  - **workloads**
    - **name** (required) -- name of this Kubernetes
            [workload](https://kubernetes.io/docs/concepts/workloads/).
            Use the same naming rules listed above for the application name.
            Provide one entry for each [workload](https://kubernetes.io/docs/concepts/workloads/)
            associated with this Keptn application.
    - **version** (required) -- version number for this [workload](https://kubernetes.io/docs/concepts/workloads/).
            Changing this number causes a new execution
            of checks for this [workload](https://kubernetes.io/docs/concepts/workloads/) only,
            not the entire application.

## Usage

Kubernetes defines
[workloads](https://kubernetes.io/docs/concepts/workloads/)
but does not define applications.
Keptn adds the concept of applications
defined as a set of workloads that can be executed.
A `KeptnApp` resource is added
into the repository of the deployment engine
(ArgoCD, Flux, etc.)
and is then deployed by that deployment engine.

A `KeptnApp` resource is created automatically, using the
[automatic application discovery](../../guides/auto-app-discovery.md)
feature to generate a `KeptnApp` resource
based on the
[basic annotations](../../guides/integrate.md#basic-annotations)
that are applied to any of the workload resources.
This allows you to use the Keptn observability features for existing resources
without manually populating any Keptn related resources.

The release lifecycle management feature
allows you to define pre- and post-deployment
evaluations and tasks to be run for the `KeptnApp` as a whole.
These must be added to the `KeptnApp` manifest manually.
Note that all evaluations or tasks for a specific stage
(such as `preDeploymentTasks`)
are executed in parallel.
If you have a series of tasks that should be executed sequentially,
you can code them all into a single `KeptnTaskDefinition`.

## Example

```yaml
apiVersion: lifecycle.keptn.sh/v1alpha3
kind: KeptnApp
metadata:
  name: podtato-head
  namespace: podtato-kubectl
spec:
  version: "latest"
  workloads:
  - name: podtato-head-left-arm
    version: "my_vers12.5"
  - name: podtato-head-left-leg
    version: "my_v24"
  postDeploymentTasks:
  - post-deployment-hello
  preDeploymentEvaluations:
  - my-prometheus-definition
```

## Files

## Differences between versions

The synopsis of the `KeptnApp` resource
is changed in `v1beta1` library:

- The `apiVersion` field now references the `v1beta1` version
  of the `lifecycle.keptn.sh` API.
- `KeptnApp` must be
  [autogenerated](../guides/auto-app-discovery.md);
  you cannot create it manually by applying a manifest.
- The `name` and `namespace` fields are populated
  from the fields of the same name in the `KeptnAppContext` resource
  and must have identical values to those
  in the corresponding `KeptnAppContext` resource.
- The `app.kubernetes.io/managed-by: keptn` label or annotation
  is new for the `v1beta1` library.
- The pre/post-deployment tasks and evaluations are now defined in the
  [KeptnAppContext](appcontext.md)
  resource rather than in `KeptnApp`.

`KeptnApp` resources that were completely autogenerated
for earlier versions are converted automatically to the new structure.
You must manually migrate older `KeptnApp` resources
that were created manually
or that were manually edited
to add `preDeployment` and `postDeployment tasks and evaluations.
For more information please refer
to the [migration section](../../migrate/keptnapp/index.md).

## See also

- [KeptnAppContext](appcontext.md)
- [KeptnTaskDefinition](taskdefinition.md)
- [KeptnEvaluationDefinition](evaluationdefinition.md)
- [Deployment tasks](../../guides/tasks.md)
- [Architecture of KeptnWorkloads and KeptnTasks](../../components/lifecycle-operator/keptn-apps.md)
- Getting started with
  [Release Lifecycle Management](../../getting-started/lifecycle-management.md)
- [Use Keptn automatic app discovery](../../guides/auto-app-discovery.md)
- [Restart an Application Deployment](../../guides/restart-application-deployment.md)
